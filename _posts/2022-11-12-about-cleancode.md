---
layout: post
title:  "클린코드 리뷰를 읽고"
date:   2022-11-12 21:29:55 +0900
categories: CS
comments: true
---
음.  
클린코드 얘기를 하면 적을 많이 만들 것 같아서 안 하려 했으나.  
내 주관을 한번 펼쳐보는 건 나쁘지 않겠다 싶어서 적어본다.  
(의견 환영합니다. 견해를 넓혀주세요)  

클린코드는 이곳저곳에서 소문이 많이 들린다.  
내가 c/c++/c# 쪽 얘기만 들어서 그런 걸 수도 있지만,  
"클린코드는 자바 진영을 벗어나면 사이비다",  
"클린코드를 읽어버린 주니어는 가망이 없다"  
라는 극단적인 의견들이 그 소문.  
뭐 소문은 언제나 극단적이긴 하다.  

"[클린코드] 함수는 작고 간결하게"  
<https://80000coding.oopy.io/b43188a4-f855-4ab1-9c50-401626c84dcd>  
그 와중에 이 글을 아까 읽어버렸다.  

주 내용은 다음과 같다.  
```md
0. 되도록 한 함수당 3~5줄 이내로 줄이는 것을 권장한다.  
1. 중첩구조(while, if / else 등) 에 들어가는 블록은 한 줄이어야 한다.  
2. 함수는 한 가지만 해라!  
3. 함수들의 추상화 수준을 맞춰라  
```  
음..  
클린코드에서 제일 말이 많은 부분이 이거다.  
**"함수는 작아야한다. 3~5줄 이내로 줄여라"**  

이게 정말 맞나..?  
함수에 대해 나 나름대로 정한 규칙이 몇 가지 있다.  
그 중 하나는 함수는 되도록 중복되거나 될 것으로 예상되는 코드에 한해서 작성한다는 것이다.  

중복되지 않는 코드를 함수로 작성하게되면 코드를 읽기 굉장히 힘들어진다.  
함수 하나 리뷰하는데, 함수 수십 개를 뒤져가며 보아야 하고,  
유지보수는 또 어떻게 하는가. 짧은 일회성 함수가 수십갠데...  
함수 호출 오버헤드는?  
뭐 이건 컴파일러와 컴퓨터가 좋아져서 상관 없다고 하는 사람도 있지만,  
최적화 잘 해준다고 해도 빌드시간은? 애초에 인라인이 제대로 될 거라는 보장이 없다.  

클린코드 읽고 극단적으로 한 줄짜리 코드도 함수화 하는 사람도 소문만 들었지 리뷰하면서 실제로 봤다.  

다른 내용도 볼까.  
```
2. 함수는 한 가지만 해라!  
3. 함수들의 추상화 수준을 맞춰라  
```  
음.. 이거 뭔가랑 비슷하다.  
SOLID 설계원칙에서 다음과 같은 내용이 있는데..  
```
Single Responsibility Principle(SRP)
- 객체는 오직 하나의 책임을 가져야 한다. (객체는 오직 하나의 변경의 이유만을 가져야 한다.)
Open-Closed Principle(OCP)
- 객체는 확장에 대해서는 개방적이고 수정에 대해서는 폐쇄적이어야 한다
```  
이거랑 느낌이 비슷하다.  
뭐가 비슷하냐면 듣는 사람마다 이 글을 이해한 내용의 편차가 너무 크다는 것이다.  

**함수는 한 가지만 해라!**  
이걸 어떻게 해석해야하나.  
예를 들어 login() 이라는 함수가 있다고 가정해보자.  
이 함수는 진짜 로그인을 진행한다! 로그인 단 한가지!  
나 그러면 이제 클린코드 마스터?  

글쎄, login()을 분해하면 DB 조회, 복호화, 대조 등의 기능으로 또 나눌 수 있을 것이다.  
그럼 이 login() 함수는 정말 한 가지 만 하는 함수가 맞을까?  

이런식으로 이해하는 사람마다 제각각이라는 것이다.  
"함수들의 추상화 수준을 맞춰라" 도 비슷하다.  
약간 이해가 될 듯 하지만 이것도 내 나름대로의 해석일 것..  

이외에도 "에러코드 대신 exception을 사용하라" 등  
클린코드는 나랑 좀 안 맞는 것 같다.  

그래도 진득하게 토론해 볼 사람이 있다면 이것저것 얘기해보고 싶다.  
설계는 주관이 잔뜩잔뜩 들어가는 영역이니...  

+ 인용한 글 저자 분께서 잘 답변을 해 주셨다.  
```md
여기서 “잘게 쪼개자”는 얘기는 예시코드 처럼 “한 함수에서는 한가지 기능을하자” 라는 의미로 쓰이고 있습니다. 분기 한개만 있거나 엄청 짧은 부분을 다 함수로 나누자는 의미는 아니었습니다.
만약 한 함수에 수백줄이 되지만 그것이 전부 다 결과적으로는 한가지의 기능을 하는 것이라면 그렇게 짜는게 좋을 수 도 있습니다. 하지만 이렇게 코드가 길어지는 경우 설계 자체가 잘못된 상황이 아닐까 싶습니다.
제가 함수를 작성하고, 다른사람이 유지보수를 한다거나 수정하는 일이 비일비재할텐데, 이 경우에 기능 하나를 고치기 위해서 어떤 함수인지 모르는 사람이 함수 하나에 대해 수백줄을 읽고 어떤기능을 하는지 파악한 후 함수를 수정하는것 자체가 유지보수성이 떨어지는것이 아닌가 싶습니다.
확장성이 좋게 최대한 잘게 쪼개서 나누어 놔야, 특정한 부분을 바꾼다거나 수정해야할 일이 있을때 딱 필요한 부분만 수정할 수 있기 때문에 나누어야 좋다는 의미라고 생각합니다.
잦은 함수 호출로 인한 성능하락 ⇒ 이부분은 컴퓨팅 자원이 유동적이지 못한 임베디드 같은 시스템에서는 1순위 인 곳에서는 맞는 말일것 같습니다.
하지만 특정하게 컴퓨팅 자원이 제한되는 상황이 아니라면, 위에서 언급했듯이 확장성 있게 만드는것이 대규모 시스템 입장에서는 경제적으로 효율적이며 기업에서 더 선호되는 방향일 것 같습니다.

추상적인 설명이 맞습니다. 이럴땐 꼭 이렇게 짜야한다 하는 정답이 없기도 하고
추상적인 인터페이스를 작성해 놓으면 그에따른 구현은 각각 벤더에서 구현하는 것과 같이, 답이 정해져 있는게 아니기 때문에 사람에따라 조직따라 그때그때 맞는 설계를 하도록 도움이 되기 위한 내용이라서 추상적일 수 밖에 없다고 생각합니다.
물론 내용을 100% 마스터해서 다양한 경우에서 다양한 예시를 들어드렸으면 정말 좋겠지만, 저도 정리를 해보고 “이런 맥락이구나” 하고 나중에 경험을 쌓으면 또 색다르게 느껴지지 않을까 싶습니다.
예시코드가 있지만, 내용이 추상적이며 긴 책의 분량을 줄여서 작성하다보니 전달이 잘 안된 부분도 있는것 같습니다.
클린코드 자체가 “절대적이다, 정답이다” 라는 목적으로 쓴 글이 아니며, 이런 설계와 패러다임 같은 것들이 어떤상황이냐에 따라 다르기때문에 정답이 없는것 같습니다.

오늘 빨리 MVP 코드를 만들고 내일 이 코드들을 갈아엎고 다시 짜야하는 스타트업에서는 이런 클린코드 원칙들이 필요없을 것이고, 한 함수에 수백줄 짜는게 때론 더 효율적일 수 있을 것같습니다.
클린코드 자체가 대규모의 협업으로 짜여진 코드에서는 많은사람들이 공감하고, 이렇게 어느정도 가이드라인을 주는것이 협업하는데 도움이되면서, 잘 되더라 하는 내용들을 모아놓았다고 생각합니다.
```  
음.  
충분히 이해가 가는 내용들이다.  
확장성.  
물론 확장성에 대해서는 클린코드 설계를 바탕으로 한 프로젝트에 참여해 본 적이 없기 때문에,  
직접 시도를 해 보던지 해서 더 생각해봐야 하는 부분이라고 생각한다.  
추상적인 주장도 팀원끼리 잘 맞고, 방향을 맞춘다면 좋은 표준이 될 수 있다고 생각한다.  